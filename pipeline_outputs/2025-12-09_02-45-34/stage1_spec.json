{
  "contract_name": "ElectionSystem",
  "contract_type": "Election",
  "description": "A smart contract for a simple, tamper-proof election system for a small community or club. It manages voter registration and identity verification, assigns a single vote per verified identity, and immutably records votes. Once the voting period ends, the contract automatically tabulates and publicly declares the winner.",
  "state_variables": [
    {
      "name": "voterRegistry",
      "type": "mapping(address => bool)",
      "visibility": "private",
      "initial_value": "{}"
    },
    {
      "name": "votes",
      "type": "mapping(address => uint256)",
      "visibility": "private",
      "initial_value": "{}"
    },
    {
      "name": "candidates",
      "type": "address[]",
      "visibility": "public",
      "initial_value": "[]"
    },
    {
      "name": "votingPeriodEnd",
      "type": "uint256",
      "visibility": "public",
      "initial_value": "0"
    },
    {
      "name": "winner",
      "type": "address",
      "visibility": "public",
      "initial_value": "address(0)"
    }
  ],
  "roles": [
    {
      "name": "admin",
      "permissions": [
        "setVotingPeriod",
        "registerVoter",
        "addCandidate"
      ]
    },
    {
      "name": "voter",
      "permissions": [
        "vote"
      ]
    }
  ],
  "functions": [
    {
      "name": "setVotingPeriod",
      "visibility": "public",
      "inputs": [
        {
          "name": "endTime",
          "type": "uint256"
        }
      ],
      "outputs": [],
      "restricted_to": "admin",
      "description": "Sets the end time for the voting period."
    },
    {
      "name": "registerVoter",
      "visibility": "public",
      "inputs": [
        {
          "name": "voter",
          "type": "address"
        }
      ],
      "outputs": [],
      "restricted_to": "admin",
      "description": "Registers a voter by verifying their identity."
    },
    {
      "name": "addCandidate",
      "visibility": "public",
      "inputs": [
        {
          "name": "candidate",
          "type": "address"
        }
      ],
      "outputs": [],
      "restricted_to": "admin",
      "description": "Adds a candidate to the election."
    },
    {
      "name": "vote",
      "visibility": "public",
      "inputs": [
        {
          "name": "candidate",
          "type": "address"
        }
      ],
      "outputs": [],
      "restricted_to": "voter",
      "description": "Allows a registered voter to cast a vote for a candidate."
    },
    {
      "name": "declareWinner",
      "visibility": "public",
      "inputs": [],
      "outputs": [
        {
          "name": "winner",
          "type": "address"
        }
      ],
      "restricted_to": "",
      "description": "Automatically tabulates votes and declares the winner after the voting period ends."
    }
  ],
  "events": [
    {
      "name": "VoterRegistered",
      "parameters": [
        {
          "name": "voter",
          "type": "address"
        }
      ]
    },
    {
      "name": "VoteCast",
      "parameters": [
        {
          "name": "voter",
          "type": "address"
        },
        {
          "name": "candidate",
          "type": "address"
        }
      ]
    },
    {
      "name": "WinnerDeclared",
      "parameters": [
        {
          "name": "winner",
          "type": "address"
        }
      ]
    }
  ],
  "modifiers": [
    {
      "name": "onlyDuringVotingPeriod",
      "condition": "block.timestamp <= votingPeriodEnd",
      "description": "Ensures that the function is called only during the voting period."
    },
    {
      "name": "onlyAfterVotingPeriod",
      "condition": "block.timestamp > votingPeriodEnd",
      "description": "Ensures that the function is called only after the voting period has ended."
    },
    {
      "name": "onlyAdmin",
      "condition": "msg.sender == admin",
      "description": "Restricts access to admin-only functions."
    },
    {
      "name": "onlyRegisteredVoter",
      "condition": "voterRegistry[msg.sender]",
      "description": "Restricts access to functions for registered voters only."
    }
  ]
}